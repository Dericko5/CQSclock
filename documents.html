<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CQS | Worker Documents</title>

  <style>
    
    .lang-toggle{
    position:fixed; top:12px; right:12px; z-index:50;
    }
    .lang-toggle a{
    font-size:12px; padding:6px 10px; border-radius:999px;
    color:#cfd3d7; text-decoration:none;
    border:1px solid rgba(255,255,255,.2);
    background:rgba(255,255,255,.08);
    backdrop-filter:blur(6px);
    transition:transform .15s;
    }
    .lang-toggle a:hover{ transform:translateY(-1px); }    

    /* ===============================
       Design tokens
       =============================== */
    :root{
      --bg-start: #0a0a0a;
      --bg-end:   #1a1a1a;
      --text:     #ffffff;
      --muted:    #9aa0a6;
      --hint:     #cfd3d7;

      --accent:   #00ff88;
      --accent-2: #00cc6a;

      --glass:    rgba(255,255,255,.08);
      --glass-br: rgba(255,255,255,.15);
      --glass-hr: rgba(255,255,255,.2);

      --shadow-strong: rgba(0,255,136,.30);
      --shadow-soft:   rgba(255,255,255,.08);
    }

    /* ===============================
       Base / Layout
       =============================== */
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body{
      min-height: 100vh;
      display: flex;
      color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, var(--bg-start), var(--bg-end));
    }

    .container{
      width: 100%;
      max-width: 480px;
      margin: auto;
      padding: 24px;
    }

    /* ===============================
       Header
       =============================== */
    .logo{
      text-align: center;
      font-size: 26px;
      font-weight: 800;
      color: var(--accent);
      text-shadow: 0 0 20px rgba(0,255,136,.3);
    }

    .subtitle{
      text-align: center;
      color: var(--muted);
      margin: 6px 0 20px;
    }

    /* ===============================
       Card
       =============================== */
    .card{
      background: var(--glass);
      border: 1px solid var(--glass-br);
      border-radius: 16px;
      padding: 18px;
      margin-bottom: 16px;
      backdrop-filter: blur(10px);
    }

    .center{
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ===============================
       Form controls
       =============================== */
    label{
      display: block;
      color: var(--hint);
      font-size: 14px;
      margin: 10px 0 8px;
    }

    input[type="text"],
    input[type="password"],
    input[type="file"]{
      width: 100%;
      padding: 14px;
      border-radius: 10px;
      border: 1px solid var(--glass-hr);
      background: rgba(255,255,255,.10);
      color: var(--text);
      margin-bottom: 14px;
      outline: none;
      transition: border-color .2s, box-shadow .2s;
    }

    input:focus{
      border-color: var(--accent);
      box-shadow: 0 0 8px rgba(0,255,136,.2);
    }

    .note{
      color: var(--muted);
      font-size: 12px;
      margin-top: -8px;
      margin-bottom: 12px;
    }

    /* ===============================
       Buttons
       =============================== */
    .btn{
      display: inline-block;
      width: 100%;
      padding: 16px;
      border: 0;
      border-radius: 12px;
      text-align: center;
      text-decoration: none;
      font-weight: 700;
      letter-spacing: .5px;
      cursor: pointer;
      transition: transform .15s, box-shadow .15s, opacity .15s;
    }

    .btn:disabled{
      opacity: .55;
      cursor: not-allowed;
    }

    .btn-primary{
      color: #000;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      box-shadow: 0 6px 24px var(--shadow-strong);
    }

    .btn-primary:not(:disabled):hover{
      transform: translateY(-1px);
    }

    .btn-ghost{
      width: auto; /* link-sized */
      background: var(--glass);
      border: 1px solid var(--glass-hr);
      color: #e5e7eb;
      padding: 12px 16px;
    }

    .btn-ghost:hover{
      transform: translateY(-1px);
      box-shadow: 0 4px 18px var(--shadow-soft);
    }

    .btn-link{
      display: inline-block;
      padding: 12px 16px;
      border-radius: 10px;
      background: linear-gradient(135deg,#1f2937,#111827);
      border: 1px solid var(--glass-br);
      color: #e5e7eb;
      text-decoration: none;
      box-shadow: 0 4px 18px rgba(0,0,0,.25);
      transition: transform .15s;
    }

    .btn-link:hover{
      transform: translateY(-1px);
    }

    /* ===============================
       Messages
       =============================== */
    .msg{
      display: none;
      padding: 12px;
      margin-bottom: 16px;
      border-radius: 10px;
      font-weight: 600;
      text-align: center;
    }

    .msg.ok{
      display: block;
      background: linear-gradient(135deg,#00ff88,#00cc6a);
      color: #000;
    }

    .msg.err{
      display: block;
      background: linear-gradient(135deg,#ff6b6b,#ee5a52);
      color: #fff;
    }

    /* ===============================
       Utilities
       =============================== */
    .spacer{ height: 10px; }

    .nav-links{margin-top:10px;text-align:center}
        .btn-link{
            display:inline-block;padding:12px 16px;border-radius:10px;
            border:1px solid rgba(255,255,255,.2);background:rgba(255,255,255,.06);
            color:#cfd3d7;text-decoration:none;font-weight:700;letter-spacing:.3px
        }
        .btn-link:hover{border-color:#00ff88;box-shadow:0 0 8px rgba(0,255,136,.2);color:#fff}
  </style>
</head>

<body>
  <div class="container">
    <div class="logo">CQS Documents</div>
    <div class="subtitle">Upload a W-9 and a Driver’s License</div>

    <div id="message" class="msg" role="status" aria-live="polite"></div>

    <!-- W-9 download (centered) -->
    <div class="card">
      <label>Need a blank W-9?</label>
      <div class="note">Tap to download, fill, then upload below.</div>
      <div class="center">
        <a id="w9Download" class="btn-link" href="/download/w9">⬇️ Download W-9 (PDF)</a>
      </div>
    </div>

    <!-- Upload form -->
    <div class="card">
      <label for="code">Access Code</label>
      <input id="code" type="password" autocomplete="one-time-code" placeholder="Enter code" required />

      <label for="firstName">First Name</label>
      <input id="firstName" type="text" placeholder="Enter first name" required />

      <label for="lastName">Last Name</label>
      <input id="lastName" type="text" placeholder="Enter last name" required />

      <label for="w9">W-9 (PDF only)</label>
      <input id="w9" type="file" accept="application/pdf,.pdf" required />

      <label for="license">Driver’s License (Image or PDF)</label>
      <input id="license" type="file" accept="image/*,application/pdf,.pdf" required />

      <button id="submitBtn" class="btn btn-primary" disabled>Submit Documents</button>

   
    </div>
       <div class="nav-links">
        <a class="btn-link" href="/index.html">← Back to Home</a>
      </div>
  </div>

  <script>
    // ---------- Helpers ----------
    const el = (id) => document.getElementById(id);
    let msgTimer = null;

    function showMsg(text, ok = true){
      const m = el('message');
      m.style.display = 'block';
      m.className = 'msg ' + (ok ? 'ok' : 'err');
      m.textContent = text;
      if (msgTimer) clearTimeout(msgTimer);
      msgTimer = setTimeout(() => { m.style.display = 'none'; }, 5000);
    }

    function enabled(){
      return (
        el('code').value.trim() &&
        el('firstName').value.trim() &&
        el('lastName').value.trim() &&
        el('w9').files[0] &&
        el('license').files[0]
      );
    }

    function updateButtonState(){
      el('submitBtn').disabled = !enabled();
    }

    // ---------- W-9 download fallback ----------
    (async () => {
    const link = document.getElementById('w9Download');
    if (!link) return;

    const exists = async (url) => {
      try {
        const r = await fetch(url, { method: 'HEAD', cache: 'no-store' });
        return r.ok;
      } catch { return false; }
    };

    // Prefer the PDF you added to the repo
    if (await exists('/w9.PDF')) {
      link.href = '/w9.PDF';
      link.setAttribute('download', 'w9.PDF'); // keep as download; remove if you want to view
      return;
    }

    // Final fallback: IRS site
    link.href = 'https://www.irs.gov/pub/irs-pdf/fw9.pdf';
    link.removeAttribute('download'); // open instead of download
      }
    )();

    // ---------- Bind events ----------
    ['code','firstName','lastName'].forEach(id => {
      el(id).addEventListener('input', updateButtonState);
      el(id).addEventListener('change', updateButtonState);
    });
    el('w9').addEventListener('change', updateButtonState);
    el('license').addEventListener('change', updateButtonState);

    // ---------- Submit ----------
    el('submitBtn').onclick = async () => {
      const btn = el('submitBtn');
      btn.disabled = true;
      btn.textContent = 'Uploading…';

      try{
        const w9 = el('w9').files[0];
        const dl = el('license').files[0];
        if (!w9 || !dl) throw new Error('Both files are required');
        if (w9.type !== 'application/pdf') throw new Error('W-9 must be a PDF');

        const fd = new FormData();
        fd.append('code', el('code').value.trim());
        fd.append('firstName', el('firstName').value.trim());
        fd.append('lastName', el('lastName').value.trim());
        fd.append('w9', w9, w9.name || 'w9.pdf');
        fd.append('license', dl, dl.name || 'license');

        const r = await fetch('/api/documents/submit', { method:'POST', body: fd });
        const j = await r.json();
        if (!r.ok) throw new Error(j.error || 'Upload failed');

        showMsg('✅ Documents uploaded successfully');

        // Reset form
        el('code').value = '';
        el('firstName').value = '';
        el('lastName').value = '';
        el('w9').value = '';
        el('license').value = '';
        btn.textContent = 'Submit Documents';
      }catch(e){
        console.error(e);
        showMsg('❌ ' + e.message, false);
        btn.textContent = 'Submit Documents';
      }finally{
        updateButtonState();
      }
    };

    // Init
    updateButtonState();
  </script>
</body>
<div class="lang-toggle" role="navigation" aria-label="Language">
  <a href="/documents-es.html" hreflang="es">ES</a>
</div>

</html>
